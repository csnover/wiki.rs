@font-face {
    font-family: source-serif;
    src: url("fonts/SourceSerif4.woff2") format(woff2);
}
@font-face {
    font-family: source-serif;
    font-style: italic;
    src: url("fonts/SourceSerif4-Italic.woff2") format(woff2);
}
@font-face {
    font-family: archivo;
    size-adjust: 96%;
    src: url("fonts/Archivo.woff2") format(woff2);
}
@font-face {
    font-family: archivo;
    font-style: italic;
    size-adjust: 96%;
    src: url("fonts/Archivo-Italic.woff2") format(woff2);
}
@font-face {
    font-family: inconsolata;
    size-adjust: 106%;
    src: url("fonts/Inconsolata.woff2") format(woff2);
}

/******************/
/* wiki.rs resets */
/******************/

:root {
    /* You think you can use a repeating-linear-gradient, but then you discover
       that browsers render a pixel horror instead of something beautiful */
    --bar-fill: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><g stroke="%23000"><line x1="0" x2="4" y1="4" y2="0" /><line x1="-2" x2="2" y1="2" y2="-2" /><line x1="2" x2="6" y1="6" y2="2" /></g></svg>');
    --bar-fill-alt: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><g stroke="%23000"><line x1="0" x2="4" y1="0" y2="4" /><line x1="2" x2="6" y1="-2" y2="2" /><line x1="-2" x2="2" y1="2" y2="6" /></g></svg>');
    --bar-fill-light: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><g stroke="%23fff" stroke-width="2"><line x1="0" x2="4" y1="4" y2="0" /><line x1="-2" x2="2" y1="2" y2="-2" /><line x1="2" x2="6" y1="6" y2="2" /></g></svg>');
    --bg: white;
    --body-bottom: 2rem;
    --body-left: 4rem;
    --body-right: 2rem;
    --border-clade: #999;
    --border-fg: lightgrey;
    --bold: 650;
    --border-th: #999;
    --box-margin: 1rem;
    --footer-margin: calc(var(--box-margin) * 4);
    --fg: black;
    --figure-margin: calc(var(--box-margin) * 2);
    --highlight: rebeccapurple;
    --mono: inconsolata, "Segoe UI Mono", "Roboto Mono", monospace, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    --normal-weight: 380;
    --ol-gutter: 1.5rem;
    /* Bad things happen to the baseline grid if this is not unitless */
    --rlh: 1.55;
    --sans: archivo, system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    --serif: source-serif, system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    --shade-bg: #f9f9f9;

    font: 0.95rem/var(--rlh) var(--serif);
    font-weight: var(--normal-weight);
    font-variant-numeric: oldstyle-nums;
    letter-spacing: -.015rem;
}

*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

:any-link {
    text-underline-position: from-font;

    &[href$="redlink=1"] {
        color: hsl(0, 50%, 20%);
        text-decoration-color: rgb(180, 0, 0);
    }

    &:hover {
        text-decoration-color: transparent;
    }
}

:link {
    color: hsl(225, 73%, 22%);
    text-decoration-color: royalblue;
}

:visited {
    color: hsl(270, 50%, 20%);
    text-decoration-color: rebeccapurple;
}

:target:target:target:target {
    background-color: lightyellow;
}

abbr {
    cursor: help;
    text-decoration: underline dotted;
}

b, strong {
    font-weight: var(--bold);
}

big {
    font-size: 1em;
}

code, kbd, pre, samp, tt, .mw-highlight /* wiki.rs <syntaxhighlight> */ {
    font-family: var(--mono);
}

cite {
    font-style: normal;
}

dt {
    font-family: var(--sans);
}

h1, h2, h3, h4, h5, h6 {
    font-family: var(--sans);
    font-variant-numeric: normal;
    hyphens: none;
}

h1 {
    font-size: 3.5rem;
    font-stretch: 80%;
    font-weight: 200;
    line-height: 1.1;
}

h2 {
    border-block-start: 3px solid currentColor;
    clear: inline-start;
    font-size: 1.5rem;
    font-stretch: semi-expanded;
    inline-size: fit-content;
    line-height: 1rlh;
    margin-inline-end: auto;
    padding-block: .1rlh .4rlh;

    + * {
        margin-block-start: var(--box-margin);
    }

    + h3 {
        margin-block-start: 0;
    }
}

h3 {
    font-size: 1rem;
    font-stretch: 150%;
    text-transform: uppercase;
}

h5 {
    font-size: 0.83em;
    font-stretch: 150%;
    text-transform: uppercase;
}

h6 {
    font-size: 0.83em;
    font-stretch: 120%;
}

hr {
    border: solid currentColor;
    border-width: 1px 0 0;
    margin-block-start: calc(1lh / 2);
    padding-block-start: calc(1lh / 2 - 1px);
}

img {
    block-size: auto;
}

math {
    font-family: var(--serif);
}

pre,
.mw-highlight {
    hyphens: none;
    /* Technically this is supposed to be the HTML default of 8, and using 4
       breaks some stuff, but for the moment it seems to make more stuff less
       ugly than it makes more ugly */
    tab-size: 4;
    white-space: pre-wrap;
    word-wrap: break-word;
}

q {
    &::before {
        content: "“";
    }

    &::after {
        content: "”";
    }
}

small {
    font-size: .9em;
}

sub {
    position: relative;
    inset-block-start: .125em;
    vertical-align: baseline;
}

sup {
    position: relative;
    inset-block-start: -.5em;
    vertical-align: baseline;
}

table {
    border-collapse: collapse;
}

th {
    font-family: var(--sans);
    hyphens: none;
}

/******************/
/* wiki.rs layout */
/******************/

.wiki-rs-body {
    align-items: baseline;
    border-block-start: .25rem solid var(--highlight);
    display: grid;
    gap: 0 4rem;
    grid-template-columns: auto 18rem;
    padding-block: 4rem var(--body-bottom);
    padding-inline: var(--body-left) var(--body-right);
}

.wiki-rs-search {
    --border-size: 2px;
    --icon-size: 1.7em;

    border-block-end: var(--border-size) solid currentColor;
    contain: paint style;
    display: flex;
    font-family: var(--sans);
    position: relative;

    &:focus-within {
        border-color: var(--highlight);
        outline: var(--border-size) solid var(--highlight);
    }

    input {
        --icon-h: calc(1em * 22 / 16);
        --icon-w: calc(1em * 20 / 16);

        all: unset;
        background: transparent url('data:image/svg+xml,<svg viewBox="0 0 20 22" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="10" r="6.5" fill="transparent" stroke="black" stroke-width="2.5" vector-effect="non-scaling-stroke"/><line x1="7.5" y1="14.5" x2="2" y2="20" stroke="black" stroke-width="2.5" vector-effect="non-scaling-stroke"/></svg>') 0 center/var(--icon-w) var(--icon-h) no-repeat;
        block-size: calc(1em * var(--rlh));
        border: 0;
        box-sizing: border-box;
        color: rgba(0, 0, 0, 0.3);
        flex: 1;
        font-family: var(--sans);
        font-size: 1em;
        padding-inline-start: var(--icon-size);

        &::placeholder {
            all: unset;
            font-family: var(--sans);
            opacity: 0;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        &:focus {
            color: var(--fg);

            &::placeholder {
                opacity: .3;
            }
        }

        &:not(:valid, :focus) {
            + label {
                visibility: visible;
            }
        }
    }

    label {
        cursor: text;
        inset-inline-start: var(--icon-size);
        line-height: var(--rlh);
        opacity: .3;
        position: absolute;
        visibility: hidden;
    }

    [type=submit] {
        all: unset;
        align-self: baseline;
        border: 1px outset transparent;
        cursor: pointer;
        line-height: calc(1em * var(--rlh) - 3px);
        margin-block: 1px;
        margin-inline: .25em 1px;
        padding-inline: .25em;
        user-select: none;
        text-decoration: underline;
        visibility: hidden;

        :focus-within > & {
            background-color: var(--shade-bg);
            border-color: var(--border-fg);
            text-decoration: none;
        }

        &:focus, &:hover {
            text-decoration: none;
        }

        &:active {
            background-color: var(--border-fg);
            border-style: inset;
        }
    }

    &:valid [type=submit] {
        visibility: visible;
    }


    /* padding-left of search + input must = --icon-size */
    .wiki-rs-index > & {
        max-inline-size: 50vi;
        min-inline-size: 21.4em;
        padding-inline-start: .15em;

        label {
            opacity: 1;
        }

        input {
            padding-inline-start: 1.55em;
        }

        [type=submit] {
            font-stretch: 75%;
            font-weight: 600;
        }
    }
}

.wiki-rs-title {
    align-items: baseline;
    display: flex;
    grid-column: 1;
    grid-row: 1;

    > * {
        min-inline-size: 0;
    }

    > :first-child {
        flex: 1;
    }

    > .mw-indicators {
        display: flex;
        white-space: nowrap;

        img {
            block-size: revert-layer;
            vertical-align: bottom;
        }

        > * + * {
            margin-inline-start: 1rem;
        }
    }
}

/* replaced content for unexpanded templates in non-module load modes */
.wiki-rs-incomplete {
    --icon-h: 1em;
    --icon-w: 1em;

    background: transparent url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M16 13h16c1.1 0 2-.9 2-2s-.9-2-2-2H16c-1.1 0-2 .9-2 2s.9 2 2 2zm0 6h16c1.1 0 2-.9 2-2s-.9-2-2-2H16c-1.1 0-2 .9-2 2s.9 2 2 2zM40 2H8a2 2 0 0 0-2 2v24.8c0 .6.4 1 .9 1.1.3 0 .6-.1.8-.3l4.2-3.9 5.9 5.6 6.2-5.7 5.5 5.1c.4.3 1 .3 1.4 0l5.3-5.1 4.1 3.7c.4.4 1 .4 1.4 0 .2-.2.3-.5.3-.8V4a2 2 0 0 0-2-2zm-2 19.9-1.2-1.1c-.4-.3-1-.3-1.4 0l-5.2 5-5.5-5c-.4-.3-1-.3-1.4 0l-5.4 5-5.3-5c-.4-.3-1-.3-1.4 0L10 22V6h28v15.9zm-2.6 7.9-5.2 5-5.5-5c-.4-.3-1-.3-1.4 0l-5.4 5-5.3-5c-.4-.3-1-.3-1.4 0L6 34.7V44c0 1.1.9 2 2 2h32a2 2 0 0 0 2-2v-9.6l-5.2-4.6c-.4-.3-1-.3-1.4 0zM38 42H10v-5.6l1.9-1.7 5.2 5c.4.3 1 .3 1.4 0l5.5-5.1 5.5 5.1c.4.3 1 .3 1.4 0l5.3-5.1 1.8 1.6V42z"/></svg>') 0 center/var(--icon-w) var(--icon-h) no-repeat;
    font-family: var(--sans);
    padding-inline: 1.1em .05em;
}

.wiki-rs-nav {
    --top: 2rem;

    display: flex;
    flex-direction: column;
    grid-column: 2;
    grid-row: 1/3;
    max-block-size: calc(100vb - var(--top) * 2);
    position: sticky;
    inset-block-start: var(--top);
}

.wiki-rs-toc {
    --scrollbar-padding: .5rem;

    font-family: var(--sans);
    font-size: 105%;
    font-stretch: 80%;
    margin-block-start: 4rem;
    margin-inline-end: calc(var(--scrollbar-padding) * -1);
    overflow-block: auto;
    padding-inline-end: var(--scrollbar-padding);
    scrollbar-width: thin;
    scrollbar-color: grey transparent;

    ul {
        list-style: none;
        padding-inline-start: 0;
        margin-inline-start: 1rem;

        > * + * {
            margin-block-start: calc(var(--box-margin) * .25);
        }
    }

    & > ul {
        margin-inline-start: 0;
    }
}

.wiki-rs-content {
    contain: inline-size layout style paint;
    container: main-article / inline-size;
    grid-column: 1;
    grid-row: 2;
    overflow: hidden;
    overflow-wrap: break-word;
    /* Weird padding and margin stuff avoids big overflows (caused by giant
       nowrap tables) whilst allowing small overflows (because normally tables
       and ordered lists bleed into the margins to keep text alignment) */
    margin-inline-start: -4rem;
    margin-inline-end: -2rem;
    padding-inline-start: 4rem;
    padding-inline-end: 2rem;
}

/**********************/
/* wiki.rs index.html */
/**********************/

.wiki-rs-index {
    align-content: center;
    font-size: 2rem;
    font-weight: 200;
    justify-content: center;
    min-block-size: 70vb;
}

/*************************/
/* wiki.rs external.html */
/*************************/

.wiki-rs-bye {
    display: flex;
    font-family: var(--sans);
    margin-block-start: 4rem;

    > svg {
        block-size: 2.25rlh;
        inset-block-start: -.075rlh;
        margin-inline-end: .5rem;
        position: relative;
    }

    > div {
        > :first-child {
            font-weight: 550;
        }

        > hr {
            margin-block: calc(var(--box-margin) * 2) calc(var(--box-margin) * .33);
        }

    }
}

/***********************/
/* wiki.rs search.html */
/***********************/

.wiki-rs-pagination {
    --gap: 2em;

    background-color: var(--bg);
    border-block-start: 3px solid currentColor;
    inset-block-end: 0;
    font-family: var(--sans);
    font-variant-numeric: tabular-nums;
    grid-column: span 2;
    margin-block: 4rem calc(var(--body-bottom) * -1);
    margin-inline-start: calc(var(--body-right) - var(--body-left));
    padding-block: .5rem var(--body-bottom);
    position: sticky;

    > ul {
        display: flex;
        gap: var(--gap);
        justify-content: center;
        list-style: none;
        padding: 0;

        > * {
            margin-block-start: 0;
            padding: 0;
            white-space: nowrap;

            /* Affordance for inaccurate fingers and tiny screens */
            > :any-link {
                margin-inline: -.5em;
                padding-inline: .5em;
            }
        }

        > .first::after,
        > .last::before {
            content: '…';
        }

        > .first::after {
            margin-inline-start: var(--gap);
        }

        > .last::before {
            margin-inline-end: var(--gap);
        }
    }
}

.wiki-rs-search-results {
    column-width: 30em;
    gap: calc(var(--ol-gutter) * 2);
    margin-block-start: 4rem;
}

.references.references,
.wiki-rs-search-results ol {
    margin-inline-start: calc(var(--ol-gutter) * -1);
    padding-inline-start: var(--ol-gutter);

    > *::marker {
        font-family: var(--sans);
        font-size: 83%;
        font-variant-numeric: tabular-nums;
    }
}

/* These are all the overrides for garbage <templatestyle>s and other defaults
   that content authored for MediaWiki expects to exist */
.mw-parser-output {
    /*********************/
    /* wiki.rs variables */
    /*********************/

    /* TODO: CSS is missing logical translate */
    --aside-gutter-align: translateX(min(0%, calc(var(--aside-max) * -1 + 100%)));
    --aside-max: calc(100cqi - var(--figure-margin) - var(--max-width));
    --aside-min: 23rem;
    --side-margin: calc(var(--box-margin) * .25);
    --side-body-stretch: 80%;
    --side-head-font-size: 1.05em;
    --side-line-height: 1.5;
    --side-title-stretch: 110%;
    --side-title-lh: 1.2;
    --side-title-lh-adjust: calc(1em * (var(--side-line-height) - var(--side-title-lh)) / 2);
    --side-title-margin: calc(var(--side-margin) + var(--side-title-lh-adjust));

    --box-tag: transparent linear-gradient(135deg, var(--fg) var(--tag-size), transparent var(--tag-size)) 0%/calc(var(--tag-size) * 2) no-repeat;
    --tag-size: .4rem;

    --legend-border: var(--fg);
    --legend-lh: .5;
    --legend-valign: baseline;
    --legend-wh: calc(1ex + 2px);

    --big-caption: 1.1rem;
    --max-width: 70rem;

    --table-margin-inline: calc(var(--table-padding-inline) * -1);
    --table-padding-block: .1rem;
    --table-padding-inline: .5rem;
    --table-width: calc(min(100%, var(--max-width)) + var(--table-margin-inline) * -2);

    /***********************/
    /* MediaWiki variables */
    /***********************/

    --background-color-base: transparent;
    --background-color-interactive: transparent;
    --background-color-interactive-subtle: transparent;
    --background-color-neutral: transparent;
    --background-color-neutral-subtle: transparent;
    --border-color-base: var(--border-fg);
    --border-color-subtle: transparent;
    --color-base: var(--fg);
    --color-subtle: var(--color-base);

    /**********/
    /* Layout */
    /**********/

    > *,
    /* `:where()` keeps less specific header, etc. styles working correctly */
    :where(
        blockquote,
        .documentation,
        .excerpt,
        .excerpt-block,
        .templatedata-header
    ) > * + * {
        margin-block-start: var(--box-margin);
    }

    /* Most content should be limited for readability, but some things look
       better if they can expand into the gutter, or (like .wikitable) are
       sometimes embedded in containers that should expand into the gutter */
    > :where(:not(
        .navbox,
        .portal-bar,
        .refbegin,
        .reflist[style*=column-width],
        .sister-bar,
        .wiki-rs-categories,
        .wikitable
    )) {
        max-inline-size: var(--max-width);
    }

    audio {
        block-size: 1rlh;
        vertical-align: top;
    }

    audio, video {
        max-inline-size: 100%;
    }

    blockquote, dd, li, p {
        /* 'Toronto' gets a lot of bad character distribution with
           shorter hyphenation limits */
        hyphenate-limit-chars: 6 3 4;
        hyphens: auto;
        text-align: justify;
        text-justify: distribute;
        text-justify: inter-character;
    }

    /* Because this element is extremely heavily abused as a mechanism for
       indenting content, we have little choice but to also do that */
    dd {
        margin-inline-start: 1rem;
    }

    dl {
        padding-inline-start: 0;
    }

    * + dt {
        margin-block-start: var(--box-margin);
    }

    * + h2 {
        margin-block-start: 5rem;
    }

    * + h3 {
        margin-block-start: calc(var(--box-margin) * 1.5);

        /* Allow many cute things to cuddle up to the heading */
        + :is(dl, p, ol, ul, .floatright, .mw-halign-left, .mw-halign-right, .excerpt-block),
        /* This is for containers that show up sometimes like `.excerpt` */
        + :not(blockquote):has(> :first-child:is(dl, ol, p, ul, .floatright, .mw-halign-left, .mw-halign-right)),
        /* Things which take themselves out of the flow by float mean the next
           thing also needs to be cuddled */
        + :is(.floatright, .mw-halign-left, .mw-halign-right) + * {
            margin-block-start: 0;
        }
    }

    :is(h4, h5, h6) + * {
        margin-block-start: 0;

        /* Things which take themselves out of the flow by float mean the next
           thing also needs to be cuddled */
        &:is(.mw-halign-left, .mw-halign-right) + * {
            margin-block-start: 0;
        }
    }

    ol, ul {
        margin-inline-start: 1rem;

        &:where(ol) {
            margin-inline-start: var(--ol-gutter);
        }

        > * {
            + * {
                margin-block-start: calc(var(--box-margin) * .25);

                .plainlist & {
                    margin-block-start: 0;
                }
            }

            > :is(ol, ul) {
                margin-block-start: calc(var(--box-margin) * .25);
            }
        }

        &:not([class]) > * {
            padding-inline-start: .1rem;

            .hlist &,
            .plainlist &,
            /* TODO: Too many templates rely on list items having no padding,
               like navbar-brackets from 'Template:Navbar' */
            &[class] {
                padding-inline-start: 0;
            }
        }
    }

    /* In MediaWiki, these empty elements would get `.mw-empty-elt`. Technically
       it would hide the display of elements with (1) no attributes and (2) only
       whitespace, but we’ll do it this way instead until it turns out we can’t.
       In particular, this hides bogus empty elements caused by list
       constructions like this:

       ```
       * {{List-item-generating template}}
       ```

       (This expands to `* \n* <template content>` due to the T2529 rule.)

       It appears that table rows should not receive this treatment since,
       apparently, empty table rows are used to fix up styles in the presence of
       rowspans, as in 'Template:Largest cities'.
    */
    :is(li, p):not([class], [style]):empty {
        display: none;
    }

    /******************/
    /* Common classes */
    /******************/

    .error {
        color: var(--highlight);
        font-family: var(--sans);
        font-weight: var(--normal-weight);
    }

    .floatleft,
    .tleft /* 'Template:Thumb image' */ {
        clear: inline-start;
        float: inline-start;
        margin-block-end: var(--figure-margin);
        margin-inline-end: var(--figure-margin);
    }

    .floatright,
    .portalright, /* 'Template:Portal' */
    .stack-clear-right, /* 'Template:Stack start' */
    .stack-right, /* 'Template:Stack start' */
    .side-box-right, /* 'Template:Side box' */
    .tright, /* 'Template:Thumb image' */
    .us-census-pop-right /* 'Template:US Census population' */
    {
        clear: inline-end;
        float: inline-end;
        margin-block-end: var(--figure-margin);
        margin-inline-start: var(--figure-margin);
        transform: var(--aside-gutter-align);
    }

    .monospaced {
        font-family: var(--mono);
    }

    .mw-redirectedfrom,
    .redirectText {
        font-family: var(--sans);

        &::before {
            content: '⮎ ';
        }
    }

    .mw-redirectedfrom::before {
        content: '⤷ ';
    }

    .nowrap {
        white-space: nowrap;

        .error {
            white-space: wrap;
        }
    }

    .selflink {
        font-weight: var(--bold);
    }

    /* 'Template:Time Persons of the Year' puts `.wrap` inside `.nowrap`, which
       is a load-bearing pattern for not breaking layout. */
    .wrap {
        white-space: normal;
    }

    /***********/
    /* Figures */
    /***********/

    figure {
        overflow: hidden;

        &.wiki-rs-timeline {
            overflow-inline: auto;
        }

        &.mw-halign-left,
        &.mw-halign-right {
            margin-block-end: var(--figure-margin);
            max-inline-size: var(--aside-max);
            min-inline-size: var(--aside-min);

            p + & {
                margin-block-start: var(--box-margin);
            }
        }

        &.mw-halign-left {
            clear: inline-start;
            float: inline-start;
            margin-inline-end: var(--figure-margin);
        }

        &.mw-halign-right {
            clear: inline-end;
            float: inline-end;
            margin-inline-start: var(--figure-margin);
            /* TODO: CSS is missing logical translate */
            transform: var(--aside-gutter-align);
        }

        img {
            display: block;
        }
    }

    figcaption {
        font-family: var(--sans);

        /* 'Template:Legend'. Sometimes it is inline, sometimes it is block.
           When it is inline, it needs extra spacing. */
        span.legend + span.legend {
            margin-inline-start: .25em;

            &::before {
                content: ' ';
                white-space: normal;
            }
        }
    }

    /*********************/
    /* wiki.rs <gallery> */
    /*********************/

    .gallery.gallery.gallery.gallery {
        border-block: thin solid var(--border-fg);
        display: grid;
        gap: var(--box-margin);
        grid-template-columns: repeat(auto-fill, 20%);
        justify-content: space-between;
        margin-inline: 0;
        padding-block: var(--box-margin);
    }

    .gallerybox {
        list-style: none;
        margin: 0;
        text-align: start;

        img {
            block-size: 120px;
        }
    }

    .gallerycaption.gallerycaption.gallerycaption.gallerycaption {
        border-block-start: 3px solid var(--fg);
        font-family: var(--sans);
        font-size: var(--big-caption);
        font-stretch: var(--side-title-stretch);
        font-weight: var(--bold);
        margin-inline: var(--table-margin-inline);
        text-align: center;

        + * {
            margin-block-start: 0;
            margin-inline: var(--table-margin-inline);
            padding-inline: var(--table-padding-inline);
        }
    }

    /**********/
    /* Tables */
    /**********/

    /* MW abuses tables for layout quite a lot, so CSS for tables that actually
       hold tabular data, not all of which are marked as .wikitable (of course),
       has to be applied only to some things */
    .wikitable,
    .bar-chart, /* 'Template:Bar chart' */
    .tracklist, /* 'Template:Track listing' */
    .us-census-pop, /* 'Template:US Census population' */
    [data-wiki-rs~=template-historical-populations] /* 'Template:Historical populations' */
    {
        border: 0;
        border-block-end: thin solid var(--border-fg);
        border-collapse: collapse;
        font-variant-numeric: tabular-nums;
        inline-size: var(--table-width);
        margin-inline: var(--table-margin-inline);

        > caption {
            background-color: transparent;
            border: 0;
            font-family: var(--sans);
            padding: 0;
        }

        > tbody > tr {
            /* Ensure zebra striped rowspans are visually separated more often
               even in the case of a rowspan */
            border-block-start: thin solid var(--bg);

            /* Zebra stripe the tables */
            &:nth-child(2n) {
                background-color: var(--shade-bg);
            }

            > :is(td, th) {
                background-color: transparent;
                border: 0;
                font-variant-numeric: tabular-nums;
                padding-block: var(--table-padding-block);
                padding-inline: var(--table-padding-inline);
                text-align: start;
            }

            > :is(
                .table-yes,
                .table-maybe,
                .table-no,
                .table-active,
                .table-siteactive,
                .table-siteinactive,
                .table-success,
                .table-failure,
                .table-yes2,
                .table-no2,
                .table-partial,
                .table-any,
                .table-automatic,
                .table-draw,
                .table-noAttempt,
                .table-na,
                .table-Un\ADknown,
                .table-included,
                .noresult,
                .table-planned,
                .table-scheduled,
                .table-beta,
                .table-experimental,
                .table-nightly,
                .table-release-candidate,
                .table-software,
                .table-free,
                .table-proprietary,
                .table-nonfree,
                .table-needs,
                .table-depends,
                .table-dropped,
                .incorrect,
                .table-debate,
                .table-cast,
            )[style*="background"] {
                --fake-transparent: var(--bg);
                background-image: linear-gradient(to right, transparent 0, transparent 5px, var(--fake-transparent) 5px) !important;
                color: var(--fg) !important;
                text-align: start !important;

                :nth-child(2n) > & {
                    --fake-transparent: var(--shade-bg);
                }
            }

            > th[colspan] {
                text-align: center;
            }

            /* This is a ridiculous hack for improving the visual design of
               tables with 2 or 3 rowspan headers by making sure that the stripe
               for the second row is also visible behind the spanned rows. Using
               `::after` to avoid conflict with 'Template:Static row numbers',
               though it could be made to work with either pseudo-element,
               probably. */
            &:first-child:has(> [rowspan]) + tr {
                position: relative;

                &::after {
                    background-color: var(--shade-bg);
                    content: "";
                    display: block;
                    inset: 0;
                    position: absolute;
                    z-index: -1;
                }
            }

            /* Table column headings should be bottom-aligned; use a heuristic
               to avoid bottom-aligning headings for row-only tables */
            &:first-child:not(:has(> td)) > th {
                vertical-align: bottom;
            }

            /* This crazy nonsense is just trying to make it so that the top
               row(s) of headings in a table have borders to separate them from
               the table data, whilst making sure that row headings do not get
               underlined */
            &:first-child > th:not([scope=row]),
            &:first-child:not(:has(> td)) + tr:not(:has(> td)) > th,
            > th[scope=col] {
                border-block-end: thin solid var(--border-th);
            }

            /* Tables without any column headings should get a top border */
            &:first-child:has(> td) {
                border-block-start: thin solid var(--border-th);
            }

            /* Assume full table spans are splitting the table into sections */
            &:not(:first-child) > th:first-child:last-child[colspan] {
                border-block: thin solid var(--border-th);
            }
        }

        /* Because there are so many selectors used to float tables, this sets
           right-float properties, and then overrides the left-float ones in
           the next CSS block */
        &.floatleft,
        &[style*="float:left"],
        &[style*="float: left"],
        &.floatright,
        &.bar-chart-right,
        &.us-census-pop-right, /* 'Template:US Census population' */
        &[data-wiki-rs~=template-historical-populations], /* 'Template:Historical populations' */
        &[style*="float:right"],
        &[style*="float: right"]
        {
            inline-size: auto;
            /* !important: 'Crazy Taxi' */
            margin-block-end: var(--figure-margin) !important;
            margin-inline: var(--figure-margin) 0 !important;
            max-inline-size: 50cqi;
            transform: var(--aside-gutter-align);
        }

        &.floatleft,
        &[style*="float:left"],
        &[style*="float: left"]
        {
            margin-inline: 0 var(--figure-margin) !important;
            /* TODO: CSS is missing logical translate */
            transform: translateX(var(--table-margin-inline));
        }

        /* 'Mount Everest' manually floats a table right after a floated right
           figure and inevitably sad things happen */
        &[style*="float:right"],
        &[style*="float: right"] {
            clear: inline-end;
        }
    }

    /* 'Mount Everest' does float left and clear */
    .wikitable:is(
        .floatleft, [style*="float:left"], [style*="float: left"],
        .floatright, [style*="float:right"], [style*="float: right"]
    ):where(:not(:has(+ [style*="clear"]))) {
        font-family: var(--sans);
        font-stretch: var(--side-body-stretch);
        font-size: unset !important;
        font-variant-numeric: tabular-nums;

        > caption {
            font-stretch: normal;
        }
    }

    /* :-((((( */
    /* 'Chelyabinsk meteor' commits this atrocity */
    [style*="float:right"]:has(> .wikitable[style*="float:right"][style*="margin"]) {
        margin-inline-start: var(--figure-margin);

        > * {
            margin-inline-start: 0 !important;
            margin-inline-end: var(--table-margin-inline) !important;
            inline-size: auto;
        }
    }

    > .wikitable[style*="width"]:not([style*="float"], .floatleft, .floatright) {
        inline-size: var(--table-width) !important;
    }

    > .wikitable[style*="border"][style*="margin"] /* 'Toronto' */
    {
        margin-inline: var(--table-margin-inline) !important;

        * + & {
            margin-block-start: var(--box-margin) !important;
        }
    }

    /* 'Toronto' */
    > .wikitable[style*="border"][style*="margin"] {
        border-width: 0 !important;
    }

    /**********************/
    /* wiki.rs categories */
    /**********************/

    .wiki-rs-categories {
        border-block-start: .25rem solid currentColor;
        clear: both;
        font-family: var(--sans);
        font-size: 95%;
        font-variant-numeric: normal;
        font-weight: 350;
        list-style: none;
        margin-block-start: var(--footer-margin);
        margin-inline: 0;
        padding-block: .5rem;
        padding-inline: 0;

        &::before {
            content: 'in: ';
            font: italic 600 1em var(--serif);
        }

        > * {
            display: inline;
        }

        > * + *::before {
            content: ' / ';
        }
    }

    /*****************/
    /* wiki.rs <ref> */
    /*****************/

    .reference {
        font-family: var(--sans);
        font-size: 75%;
        font-stretch: normal;
        font-variant-numeric: normal;
        inset-block-start: -.5em;
        position: relative;
        text-decoration: none;
        white-space: nowrap;

        &::before {
            content: '[';
        }

        &::after {
            content: ']';
        }
    }

    /************************/
    /* wiki.rs <references> */
    /************************/

    /* The first child is currently always the backref link */
    .mw-cite-backlink > :first-child {
        /* Make the first paragraph a run-in for the backref link */
        + p {
            display: inline;
        }

        /* Make the first list a run-in for the backref link, and also put the
           bullets in line with the reference list’s bullets */
        + ul {
            display: inline;
            margin-inline-start: 0;

            > :first-child {
                display: inline;
                padding-inline-start: 0;
            }
        }
    }

    /**********************/
    /* wiki.rs <timeline> */
    /**********************/

    .wiki-rs-timeline {
        font-family: var(--sans);
    }

    .wiki-rs-timeline-main-axis,
    .wiki-rs-timeline-cross-axis {
        font-variant-numeric: lining-nums;
    }

    /*************************/
    /* Template:!mxt         */
    /* Template:Section link */
    /*************************/

    [style*="font-family: monospace"],
    [style*="font-family:monospace"] {
        font-family: var(--mono) !important;
    }

    /***********************/
    /* Template:Ahnentafel */
    /***********************/

    [data-wiki-rs~=template-ahnentafel] {
        font-family: var(--sans);

        > table {
            border: none !important;
            font-size: 1em !important;
        }

        .ahnentafel {
            font-stretch: var(--side-body-stretch);

            td {
                border-color: var(--border-th) !important;

                &[style*=background-color] {
                    background-image: var(--bar-fill-light);
                    background-position: 0;
                }
            }
        }
    }

    /*******************************************/
    /* Template:Article for improvement banner */
    /*******************************************/

    [data-wiki-rs~=template-article-for-improvement-banner] {
        text-align: inherit !important;
    }

    /******************/
    /* Template:Asbox */
    /* Template:Dmbox */
    /******************/

    .asbox, .dmbox {
        border-block-start: thin solid var(--fg);
        font-family: var(--sans);
        max-inline-size: none;

        * + & {
            border-block-end: 0;
            margin-block: var(--footer-margin) 0;
            margin-inline: 0;
            padding-block: .5rem;
            padding-inline: 0;
        }

        + &,
        + .wiki-rs-categories {
            margin-block-start: 0;
        }
    }

    .asbox-body, .dmbox-body {
        font-style: normal;
    }

    /*********************/
    /* Template: Bar box */
    /*********************/

    .barbox {
        font-family: var(--sans);
        font-stretch: var(--side-body-stretch);
        overflow-inline: visible !important;

        table {
            inline-size: var(--table-width);
            margin-inline: var(--table-margin-inline);
        }

        td, th {
            font-variant-numeric: tabular-nums;
        }

        tr {
            &:nth-child(2) {
                display: none;
            }

            &:first-child,
            &:last-child {
                border-block-end: thin solid var(--border-th);
            }

            &:first-child {
                border-color: var(--fg);

                > th {
                    padding-inline: var(--table-padding-inline);
                }
            }
        }

        > div {
            background: transparent !important;
            border: none !important;
            font-size: 1rem !important;
            padding: 0 !important;
        }
    }

    /*************************/
    /* Template: Bar chart   */
    /* Template: Bar percent */
    /*************************/

    .bar-chart {
        border: none;

        caption {
            font-family: var(--sans);
            font-weight: var(--normal-weight);
            font-stretch: normal;
        }

        /* HOVER EFFECTS ARE INCREDIBLY OBNOXIOUS. */
        tr:not(:first-child):nth-child(2n):hover {
            background-color: var(--shade-bg);
        }
    }

    .bar-chart tr,
    [data-wiki-rs~=template-bar-percent] {
        &:nth-child(2n) {
            background-color: var(--shade-bg);
        }

        > td {
            &:first-child {
                min-inline-size: 0 !important;
            }

            &:nth-child(2) {
                border-inline-end: none !important;
                border-inline-start: thin solid var(--fg) !important;
                inline-size: auto !important;
                min-inline-size: 100px;
                padding: 0;
            }

            &:last-child {
                padding-inline-end: var(--table-padding-inline);
            }
        }
    }

    .bar-chart-bar {
        display: inline-block;
        inline-size: auto !important;
        white-space: nowrap;
    }

    .bar-chart-bar-line,
    [data-wiki-rs~=template-bar-percent] > td > div {
        background: var(--bar-fill) !important;
        block-size: 1em;
        border: thin solid black;
        border-inline-start: 0;
        display: inline-block;
        vertical-align: middle;
    }

    .bar-chart-bar-numbers {
        background: var(--bg);
        background-clip: content-box;
        font-family: var(--sans);
        font-size: 90%;
        font-stretch: 110%;
        margin-inline-start: 0.15em;
        padding-inline: 0;
        position: static;
    }

    .bar-chart-right {
        font-stretch: var(--side-body-stretch);
    }

    /***********************/
    /* Template:Blockquote */
    /***********************/

    blockquote,
    .templatequote {
        font-style: italic;
        margin-block-end: 0;
        padding-inline: 2.5rem;

        em, em em em, em em em em em {
            font-style: normal;
        }

        em em, em em em em, em em em em em em {
            font-style: italic;
        }
    }

    .templatequote {
        overflow: visible;
    }

    .templatequotecite {
        font-family: var(--sans);
        line-height: 1rlh;
        margin-block-start: .5em;
        text-align: end;

        em, em em em, em em em em em {
            font-style: italic;
        }

        em em, em em em em, em em em em em em {
            font-style: normal;
        }
    }

    /*******************/
    /* Template:Button */
    /*******************/

    [style*="font-family: sans-serif"],
    [style*="font-family:sans-serif"] {
        font-family: var(--sans) !important;
    }

    /*********************/
    /* Template:CN span  */
    /* Template:Fix span */
    /*********************/

    .citation-needed-content {
        border: 0 !important;
        padding-inline: 0 !important;
        text-decoration: underline wavy var(--border-th);

        + .Template-Fact {
            margin-inline-end: .15em;
            margin-inline-start: -.15em !important;
        }
    }

    /*****************************/
    /* Template:Chart top        */
    /* Template:Tree chart start */
    /*****************************/

    [data-wiki-rs~=template-chart-top] {
        border: 0 !important;

        * + & {
            margin: 0 !important;
            margin-block-start: var(--box-margin) !important;
        }

        > tbody > tr:first-child > th {
            border-block-end: thin solid var(--fg);
            border-block-start: 3px solid var(--fg);
            font-stretch: var(--side-title-stretch);
            font-size: 1.05rem;
        }
    }

    [data-wiki-rs~=template-tree-chart-start] {
        font-size: .95rem !important;
        font-family: var(--sans);
        font-stretch: 80%;
    }

    /**************************/
    /* Template:Clade gallery */
    /**************************/

    > .clade-gallery.clade-gallery {
        display: block;
        font-family: var(--sans);
        margin-inline: 0;

        * + & {
            margin-block-start: var(--box-margin);
        }

        .clade * {
            border-color: var(--border-clade);
        }

        .clade-leaf {
            &:first-letter {
                padding-inline-start: .15em;
            }

            b {
                font-stretch: normal;
            }

            img {
                /* Without images to load, avoid blowing out the layout */
                max-block-size: 1em;
                vertical-align: middle;
            }
        }

        .cladogram.cladogram {
            font-stretch: var(--side-body-stretch);
            padding: 0;
        }

        .gallery-element {
            border: none;
        }

        .main-caption,
        .main-content {
            padding: 0;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: var(--box-margin);

            > * {
                flex: 1;
            }
        }
    }

    /**************************/
    /* Template:Climate chart */
    /**************************/

    /* .infobox is for extra specificity */
    [data-wiki-rs~=template-climate-chart].infobox {
        --heat-gradient: linear-gradient(to bottom, red 20%, blue 80%);

        border: none !important;
        font-variant-numeric: lining-nums;
        margin-block-end: var(--figure-margin) !important;

        &[style*="float: left"] {
            margin-inline-end: var(--figure-margin) !important;
        }

        &[style*="float: right"] {
            margin-inline-start: var(--figure-margin) !important;
        }

        /* axis display, part 1 */
        [style*="bottom:dotted"] {
            display: none;
        }

        /* axis display, part 2 */
        tr:has(> td > [style*="position:relative"]) {
            background: #fff url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="3" height="2"><circle cx="1" cy="1" r=".5" fill="%23999" /></svg>')  repeat-x 0 calc(50% + .5em);
            position: relative;

            > :first-child::before {
                background-image: var(--heat-gradient);
                content: '';
                inset: 0 0 1.5em;
                mix-blend-mode: screen;
                pointer-events: none;
                position: absolute;
                z-index: 1;
            }
        }

        [data-wiki-rs~=template-climate-chart-celsius-column],
        [data-wiki-rs~=template-climate-chart-celsius-column-i],
        [data-wiki-rs~=template-climate-chart-fahrenheit-column],
        [data-wiki-rs~=template-climate-chart-fahrenheit-column-i] {
            /* improve legibility of labels on the axis */
            span {
                background-color: #fff;
                color: #000 !important;
                margin-inline: -.15em;
                padding-inline: .15em;

                &[style*="font-size\:70%"] {
                    font-size: 80% !important;
                    font-stretch: var(--side-body-stretch);
                }
            }

            /* the actual temperature and precipitation bars */
            div[style*="background:#e44"],
            div[style*="background:#ace"] {
                background: var(--bar-fill) !important;
                border: thin solid #000;
                /* to stop unscaled giant precipitation interfering with the
                   title link */
                pointer-events: none;
            }

            div[style*="background:#ace"] {
                background: var(--bar-fill-alt) !important;
            }
        }

        th {
            border-block-start: thin solid var(--fg);
            font-size: 1rem !important;
        }

        /* legend swatches */
        td[colspan] > span:first-child:not(.reference) {
            border: 1px solid var(--legend-border);
            block-size: var(--legend-wh);
            color: transparent !important;
            display: inline-block;
            inline-size: var(--legend-wh);
            line-height: var(--legend-lh);
            vertical-align: var(--legend-valign);

            &[style*="red"],
            &[style*="#aaccee"] {
                background: var(--heat-gradient), var(--bar-fill), #fff !important;
                background-blend-mode: screen, normal, normal;
                color: transparent !important;
            }

            &[style*="#aaccee"] {
                background: var(--heat-gradient), var(--bar-fill-alt), #fff !important;
                color: transparent !important;
            }
        }

        .infobox {
            margin-block-start: calc(var(--box-margin) * .5) !important;
            margin-inline-end: 0 !important;

            th {
                /* The emulated margin-block-start of a secondary conversion chart */
                padding-block-end: calc(var(--box-margin) * .25);
            }
        }

        > tbody > tr {
            &:first-child > th {
                border-block-start: 3px solid var(--fg);
                font-stretch: var(--side-title-stretch);
            }

            > td > .infobox {
                /* The margin-block-start of the primary conversion chart */
                margin-block-start: calc(var(--box-margin) * .25) !important;
            }
        }
    }

    /************************/
    /* Template:Compact TOC */
    /************************/

    .toc {
        border-block-start: 3px solid currentColor;
        font-family: var(--sans);

        .toctitle {
            font-stretch: 120%;

            + * {
                border-block-start: thin solid var(--border-fg);
                padding-block-start: calc(var(--box-margin) * .25);
            }
        }

        > div {
            text-align: center;
        }
    }

    /********************/
    /* Template:Div col */
    /********************/

    * + .div-col {
        margin-block-start: var(--box-margin);
    }

    .div-col-rules {
        column-rule: none;
    }

    /**************************/
    /* Template:Documentation */
    /**************************/

    .documentation {
        background-color: transparent;
        border: 0;
        padding: 0;

        > :where(:not(.documentation-startbox)) {
            max-inline-size: var(--max-width);
        }

        [style*="display: inline-grid"] {
            + [style*="display: inline-grid"] {
                margin-inline-start: var(--box-margin);
            }

            .wikitable {
                inline-size: auto;
                margin-inline: 0;
            }
        }
    }

    .documentation-container {
        clear: both;
        max-inline-size: none;

        * + & {
            border-block-start: 3px solid currentColor;
            margin-block-start: 2rem;
            padding-block-start: .5rem;
        }
    }

    .documentation-heading {
        font-stretch: 120%;

        img {
            max-block-size: 1cap;
        }
    }

    .documentation-metadata {
        background-color: transparent;
        border: 0;
        border-block-start: 3px solid;
        font-family: var(--sans);
        font-style: normal;
        padding: 0;
        padding-block-start: .5rem;
        margin: 0;
        margin-block-start: 4rem;
    }

    .documentation-startbox {
        align-items: baseline;
        border-block-end-color: var(--fg);
        display: flex;
        font-family: var(--sans);
        padding: 0;
        margin-block-end: 0;

        > :first-child {
            flex: 1;
        }
    }

    /********************/
    /* Template:Excerpt */
    /********************/

    /* This is a viewer, so no reason to show edit links */
    .excerpt-hat .mw-editsection-like {
        display: none;
    }

    /*********************/
    /* Template:Flagicon */
    /*********************/

    /* Without images to load, avoid blowing out the layout. Flag images are
       shorter than the placeholder wiki.rs uses */
    .flagicon img {
        max-block-size: 1cap;
    }

    /*************************/
    /* Template:Football kit */
    /*************************/

    [data-wiki-rs~=template-football-kit] > :last-child {
        padding-block-start: 0 !important;
    }

    /********************/
    /* Template:Gallery */
    /********************/

    .mod-gallery,
    .mod-gallery > .main,
    .mod-gallery > .main > div {
        display: block;
    }

    > * + .mod-gallery {
        margin-block-start: var(--box-margin);
    }

    /********************/
    /* Template:Hatnote */
    /********************/

    /* Keep hatnotes, and headings cuddled, ignoring any intermediate elements
       which move themselves out of the way by floating */
    .hatnote.hatnote {
        margin-block-end: 0;
        padding-inline-start: 0;

        :is(h2, h3, h4, h5, dl:has(> dt:first-child:last-child)) + &,
        .hatnote + &,
        .hatnote + .mw-halign-right + & {
            margin-block-start: 0;
        }
    }

    /*************************/
    /* Template:Hidden begin */
    /*************************/

    .hidden-begin {
        border: 0 !important;

        &:has(+ .navbox-styles, + .navbox) {
            margin-block-start: var(--footer-margin);
        }
    }

    .hidden-title {
        border-block-start: 3px solid var(--fg);
        border-block-end: thin solid var(--border-th);
        font-family: var(--sans);
        font-size: var(--big-caption);
        font-stretch: var(--side-title-stretch);
    }

    /***********************************/
    /* Template:Historical populations */
    /* Template:US Census population   */
    /***********************************/

    .us-census-pop,
    [data-wiki-rs~=template-historical-populations] {
        border-block-end: none;
        margin-block: 0 var(--figure-margin) !important;
        margin-inline: var(--table-margin-inline) var(--figure-margin) !important;

        caption {
            border-block-end: thin solid var(--border-th);
            padding: 0 !important;
        }

        td, th {
            padding-block: var(--table-padding-block) !important;
            padding-inline: var(--table-padding-inline) !important;
        }

        td {
            font-family: var(--sans);
            font-stretch: var(--side-body-stretch);
            font-variant-numeric: tabular-nums;
        }

        tr:last-child:last-child:last-child {
            background-color: transparent;

            > * {
                border-block-start-color: var(--border-fg) !important;
                border-block-start-width: thin !important;
                font-stretch: normal;
            }
        }
    }

    /* 'Tromsø' */
    [data-wiki-rs~=template-historical-populations][style*="float:none"] {
        font-size: 1em !important;
        inline-size: var(--table-width);
        margin-inline: var(--table-margin-inline);
        max-inline-size: none;

        td {
            &:not(:first-child) {
                padding-inline-start: calc(var(--table-padding-inline) * .5) !important;
            }

            &:not(:last-child) {
                padding-inline-end: calc(var(--table-padding-inline) * .5) !important;
            }
        }
    }

    [data-wiki-rs~=template-historical-populations]:where([style*="float:right"], [style*="float:left"]) {
        caption, th {
            font-stretch: var(--side-body-stretch);
        }
    }

    /***************************/
    /* Template:Image frame    */
    /* Template:Multiple image */
    /***************************/

    .thumb {
        font-family: var(--sans);

        /* api.php?meta=siteinfo&siprop=general thumblimits maxes out at 400 */
        /* !important: 'Module:Wide image' defaults non-existing image width to
           0 (and therefore max-width to 10px) */
        &[style*="max-width\:10px"] {
            max-inline-size: 400px !important;
        }

        .multiimageinner[style*="max-width:100px"] {
            /* !important: This module blindly calculates values even if none
               are available, which means it ends up forced to 100px wide */
           inline-size: auto !important;
            max-inline-size: none !important;
        }

        .trow {
            gap: calc(var(--figure-margin) / 2);

            > * {
                flex: 1 1 0%;
                min-inline-size: 0;
            }

            .thumbimage:has(~ .text-align-center) {
                text-align: center;
            }

            + .trow {
                margin-block-start: var(--box-margin);
            }
        }

        .tsingle {
            margin: 0;
        }
    }

    /********************/
    /* Template:Infobox */
    /* Template:Sidebar */
    /********************/

    /* This very silly nonsense is required because 'World War II' expects to
       be able to put an infobox in a 'Template:Stack' along with a navbox and
       use the same em-width on both children and have them come out the same
       size. The default MW stylesheet sets `.infobox` font size to 88%. */
    .infobox, .sidebar {
        font-size: 88%;

        > * {
            font-size: 1rem;
        }
    }

    .infobox.infobox.infobox,
    .sidebar.sidebar {
        --caption-size: .9rem;
        --label-baseline-align: var(--side-title-lh-adjust);

        background: transparent !important;
        border-block: 3px solid var(--fg);
        border-inline: 0;
        clear: inline-end;
        color: var(--fg) !important;
        float: inline-end;
        font-family: var(--sans);
        line-height: var(--side-line-height) !important;
        margin-block: var(--box-margin) var(--figure-margin);
        margin-inline: var(--figure-margin) 0;

        [style*=line-height] {
            line-height: inherit !important;
        }

        /* 'Elizabeth II' nests infoboxes, so only the root box should be
            sized. Also, 'Template:Climate chart' uses infobox and floats to the
            left, so should not receive explicit sizing either. */
        :is(
            .mw-parser-output,
            .documentation,
            .hidden-content
        ) > &:not([style*="float: left"]) {
            max-inline-size: var(--aside-max);
            min-inline-size: var(--aside-min);
            transform: var(--aside-gutter-align);
        }

        li {
            text-align: inherit;
        }

        * + dt,
        * + li {
            margin-block-start: 0;
        }

        /* The CSS table box model puts captions visually outside of the table.
           When infoboxes use a caption, it should look the same as if they used
           a table heading. */
        &:has(> caption) {
            border-block-start: 0;
        }

        /* Anything following a block that creates a block-end border needs
           padding. The DOM for a caption is special, so needs a special
           selector */
        > caption + tbody > tr:first-child > * {
            padding-block-start: var(--side-margin);
        }

        /* Nested tables bring trouble if this were to apply to all tr inside
           an infobox or sidebox */
        > tbody > tr,
        /* Avoiding specificity here to deal with .infobox-label needing a
           default bottom padding due to the reduced line-height */
        &:where(.vcard) > :where(tbody) > :where(tr) > :where(td) > :where(table) > :where(tbody) > :where(tr) {
            /* Authors are obsessed with inline colours */
            background: transparent !important;
            color: var(--fg) !important;

            /* Anything following a block that creates a block-end border needs
               padding */
            &:has(> :is(
                .infobox-above,
                .infobox-title,
                .sidebar-title,
                .sidebar-title-with-pretitle
            )) + tr > * {
                padding-block-start: var(--side-margin);
            }

            /* Anything following an image block, which is not another image
               block, needs a block-start border and padding */
            &:has(> :is(
                .infobox-image,
                .sidebar-image
            )) + tr > :not(
                .infobox-image,
                .sidebar-image
            ),
            /* This also applies to subheaders, but the interaction between a
               subheader followed by an image means that the previous rule would
               not work correctly if subheader were added to it */
            &:has(> .infobox-subheader) + tr > :not(.infobox-subheader) {
                border-block-start: thin solid var(--fg);
                padding-block-start: var(--side-margin);
            }

            /* Anything preceding a block that creates a block-start border
               needs padding, and anything immediately below the end of the
               table needs the same */
            &:has(+ .mergedtoprow),
            &:has(+ tr > :is(
                .infobox-below,
                .infobox-header,
                .sidebar-below
            )),
            &:last-child {
                > * {
                    padding-block-end: var(--side-margin);

                    &.infobox-label {
                        padding-block-end: calc(var(--side-margin) + var(--label-baseline-align));
                    }
                }
            }

            /* Sidebar navbar has no top border, so anything before it should not
            have block-end padding so they flow together */
            &:has(> .infobox-subheader):has(+ tr > .infobox-subheader) > *,
            &:has(+ tr > .sidebar-navbar) > * {
                padding-block-end: 0;
            }

            > :where(td, th) {
                /* Many of the default templatestyles for infobox variants apply
                   default borders to cells and then selectively remove the
                   borders */
                border-color: var(--fg) !important;

                padding: 0;
                vertical-align: top;

                /* In an embedded 'Template:Multiple image', give an unlabelled
                   caption outside the collage a compressed text. Also justify
                   the caption, since this box is narrow, so it looks bad with
                   jagged edges. */
                &:has(> .tmulti) {
                    font-stretch: var(--side-body-stretch);
                    text-align: justify;
                    text-align-last: center;

                    > .hlist {
                        font-size: var(--caption-size);
                        font-stretch: normal;
                        text-align: justify;
                        text-align-last: center;
                    }
                }

                /* Give the actual collage captions smaller non-compressed
                   text */
                > .tmulti {
                    font-size: var(--caption-size);
                    font-stretch: normal;
                    text-align: center;

                    .trow + .trow {
                        margin-block-start: var(--side-margin);
                    }
                }

                /* TODO: Maybe 'Template:Hidden begin' should just never have
                   padding globally */
                > .hidden-begin {
                    padding: 0;
                }
            }
        }

        /* These are the main styles for the title of all infobox/sidebox */
        > caption,
        .infobox-above,
        .infobox-title,
        .sidebar-title,
        .sidebar-title-with-pretitle,
        &.vevent > tbody > tr:first-child > *
        {
            background: transparent !important;
            border-block: thin solid var(--fg) !important;
            border-block-start-width: 3px !important;
            border-inline: 0 !important;
            color: var(--fg) !important;
            font-size: var(--big-caption) !important;
            font-stretch: var(--side-title-stretch);
            font-weight: var(--bold);
            line-height: var(--side-title-lh) !important;
            padding-block: var(--side-title-margin) !important;
            text-align: center;

            /* Too many things decide to try to be cute with the font size */
            &[style*=font-size] {
                font-size: var(--big-caption) !important;
            }

            /* …aggressively cute… */
            :where([style*=font-size]) {
                font-size: inherit !important;
            }

            /* Same thing with the font colour */
            .tmp-color,
            .tmpl-colored-link {
                color: inherit !important;
            }
        }

        .infobox-below,
        .sidebar-below {
            border-block: thin solid var(--fg) !important;
            border-block-end: 0 !important;
            padding-block: var(--side-margin);
            text-align: center;
        }

        .infobox-data {
            text-align: start;
        }

        .infobox-full-data {
            font-stretch: var(--side-body-stretch);

            &:has(> .infobox) {
                border-block-end: thin solid var(--fg);
                padding-block-start: var(--side-margin);

                > .infobox > tbody > tr:first-child > * {
                    padding-block-start: var(--side-margin);
                }
            }

            &:empty:empty {
                border-block-start: 0;
                padding-block-start: 0;
            }
        }

        .infobox-full-data > :any-link > img,
        .infobox-full-data > img,
        .infobox-image img,
        .ib-settlement-cols img,
        .sidebar-image img {
            background-color: transparent;
            display: block;
            inline-size: 100%;
            margin-inline: auto;
            /* Since there is currently no way to load any actual images,
                avoid taking up a bunch of space on giant placeholders */
            max-block-size: 3rlh;
        }

        .infobox-header,
        .sidebar-heading {
            background: transparent !important;
            font-size: var(--side-head-font-size) !important;
            font-stretch: var(--side-body-stretch);
            font-weight: var(--bold);
            line-height: var(--side-title-lh) !important;
            padding-block: 0 var(--side-title-lh-adjust);
            padding-inline: 0 !important;
            text-align: start;

            /* 'Elizabeth II' */
            &:has(> div:empty:first-child:last-child) {
                display: none;
            }
        }

        .infobox-header {
            border-block-start: thin solid var(--fg);
            padding-block-start: var(--side-margin);
        }

        .infobox-image,
        .sidebar-image {
            font-size: var(--caption-size);
            padding-block-end: var(--side-margin);
            text-align: center;

            img {
                display: block;
                inline-size: 100%;
                margin-inline: auto;
                /* Since there is currently no way to load any actual images,
                   avoid taking up a bunch of space on giant placeholders */
                max-block-size: 3rlh;
            }
        }

        .infobox-label,
        &:is(.biota, .ib-chembox) > tbody > tr > td:first-child:not(:last-child) {
            font-stretch: var(--side-body-stretch);
            font-weight: var(--bold);
            line-height: var(--side-title-lh);
            padding-inline-end: .3rem;
            padding-block-end: var(--label-baseline-align);
            text-align: start;
            /* keep first baseline alignment w/ reduced line height */
            /* TODO: CSS is missing logical translate */
            transform: translateY(var(--label-baseline-align));
        }

        .infobox-navbar,
        .sidebar-navbar {
            text-align: end;
        }

        .infobox-subheader {
            background-color: transparent;
            padding-block-end: var(--side-margin);
            text-align: center;
        }

        .mergedtoprow {
            > * {
                padding-block-start: var(--side-margin);

                &:has(> .hidden-begin) {
                    border-block-start: 0;
                    padding-block-start: 0;
                }
            }
        }

        .sidebar-below {
            font-size: var(--caption-size);

            > br {
                display: none;

                + * {
                    margin-inline-start: .3em;
                }
            }
        }

        .sidebar-content {
            background: transparent !important;
            color: var(--fg) !important;
            font-size: 1em !important;
            font-stretch: var(--side-body-stretch);
            padding-inline: 0;
            text-align: start !important;
        }

        .sidebar-heading {
            padding-block-start: var(--side-margin);
        }

        .sidebar-list-title {
            border-block-start: 0 !important; /* 'Template:Sidebar periodic table' */
            font-size: var(--side-head-font-size) !important;
            line-height: calc(1em / var(--side-head-font-size));
            font-weight: var(--bold);
            padding-inline: 0;
        }

        /* This always comes before a .sidebar-title-with-pretitle */
        .sidebar-pretitle {
            background: transparent !important;
            color: var(--fg) !important;
            padding-block-start: var(--side-title-margin);
        }

        .sidebar-subgroup > tbody > tr:last-child > * {
            padding-block-end: 0;
        }

        /* This always comes after a .sidebar-pretitle */
        .sidebar-title-with-pretitle {
            border-block-start: 0 !important;
            padding-block-start: 0 !important;
        }

        /********************/
        /* Template:Chembox */
        /********************/

        &.ib-chembox,
        &[data-wiki-rs~=template-infobox-drug] {
            > tbody > tr {
                &:first-child > [colspan]:has(> img, > * > img) {
                    padding-block: var(--side-margin) !important;
                    padding-inline: 0 !important;
                }

                > :is(td, th) {
                    background: transparent !important;
                    border: 0;
                }

                &:has(+ tr > th[colspan]) > * {
                    padding-block-end: var(--side-margin);
                }

                &:has(> th[colspan]) + tr > * {
                    padding-block-start: var(--side-margin);
                }

                > th[colspan] {
                    background: transparent !important;
                    border-block: thin solid var(--fg);
                    color: var(--fg) !important;
                    padding-block: var(--side-margin);
                }

                &:first-child > th[colspan] {
                    border-block-start: 0;
                }

                &:has(> td[colspan] > [style*=padding-left]) + tr > td[colspan]:has(> [style*=padding-left]) {
                    padding-block-start: var(--side-margin);
                }

                > td[colspan] {
                    font-stretch: var(--side-body-stretch);

                    &:has(> [style*=word-wrap]) {
                        font-weight: var(--bold);
                    }

                    &.borderless {
                        td {
                            border: 0 !important;
                        }
                    }

                    > :not(.plainlist)[style*=padding-left] {
                        font-weight: var(--normal-weight);
                        padding-inline: 0 !important;
                    }

                    > .mw-collapsible {
                        > :not(.mw-collapsible-content) {
                            font-weight: var(--bold) !important;
                        }

                        > .mw-collapsible-content {
                            font-family: var(--mono);
                            font-weight: var(--normal-weight);

                            &:is(ul):has(> :nth-child(2)) {
                                list-style: decimal !important;
                                padding-left: .83em;

                                > *::marker {
                                    font-family: var(--sans);
                                    font-stretch: normal;
                                    font-size: .83em;
                                    font-variant-numeric: tabular-nums;
                                }
                            }

                            [style*=border] {
                                border: 0 !important;
                            }

                            [style*=padding] {
                                padding: 0 !important;
                            }

                            [style*=font-size] {
                                font-size: inherit !important;
                            }

                            [style*=text-indent] {
                                padding-inline-start: 1em !important;
                                text-indent: -1em !important;
                            }
                        }
                    }
                }
            }
        }

        /****************************/
        /* Template:Infobox country */
        /****************************/

        .ib-country-names {
            font-size: var(--caption-size);
        }

        &.ib-country,
        &.ib-uk-place {
            .infobox-label > [style*=text-indent],
            .ib-country-fake-li {
                margin-inline-start: 1ch !important;
                text-indent: -1ch !important;
            }

            .infobox-data > table {
                inline-size: 100%;

                [style*=font-size] {
                    font-size: 1em !important;
                }

                td, th {
                    border: 0;
                }

                th[colspan] {
                    border-block: thin solid var(--border-fg);
                    border-block-start-color: var(--border-th);
                }

                tr:nth-child(2n) {
                    background-color: var(--shade-bg);
                }

                tr:first-child > th[colspan] {
                    border-block-start: 0;
                }
            }

            td, th {
                padding: 0;

                &.infobox-label {
                    padding-inline-end: .3rem;
                }
            }

            > tbody {
                > :not(.mergedrow, .mergedbottomrow) > :is(td, th) {
                    padding-block-start: var(--side-margin);
                }

                > :has(+ tr:not(.mergedrow, .mergedbottomrow) > *) > * {
                    padding-block-end: var(--side-margin);

                    &.infobox-label {
                        padding-block-end: calc(var(--side-margin) + var(--label-baseline-align));
                    }
                }
            }
        }

        /*******************************************/
        /* Template:Infobox element/periodic table */
        /*******************************************/

        .periodictable > tbody > tr:first-child > td > div [style*=background-color] {
            background-blend-mode: overlay;
            background-image: var(--bar-fill) !important;
            background-size: 4px 4px !important;
        }

        /**********************************/
        /* Template:Infobox football club */
        /**********************************/

        /* lol :-( */
        > tbody > tr > td:has(> table > tbody > tr > td > [data-wiki-rs~=template-football-kit]) {
            border: 0 !important;

            [data-wiki-rs~=template-football-kit] {
                border: 0 !important;
                inline-size: auto !important;
                margin-block: var(--side-margin) !important;
                margin-inline: 0 !important;
                padding: 0 !important;
            }
        }

        /**************************************/
        /* Template:Infobox military conflict */
        /**************************************/

        &.vevent {
            > tbody > tr {
                /* “Part of” */
                &:nth-child(2) > * {
                    background: transparent !important;
                    color: var(--fg) !important;
                    padding-block-start: calc(var(--side-margin) * .5);
                }

                /* Image part, if one exists */
                &:is(
                    :nth-child(2),
                    :nth-child(3)
                ):has(
                    > td > :any-link > img,
                    > td > img,
                    > td > .tmulti
                ) > * {
                    padding-block: var(--side-margin);
                    font-size: var(--caption-size);
                    text-align: justify;
                    text-align-last: center;

                    &:has(> .tmulti) {
                        font-size: 1em;
                    }
                }

                /* Belligerents, strength, etc. */
                > th[colspan]:not(.summary) {
                    background-color: transparent !important;
                    border-block-start: thin solid var(--fg);
                    border-block-end: thin solid var(--border-th) !important;
                    color: var(--fg) !important;
                    font-size: 1em !important;
                }

                > td[style*=border-right] {
                    border-inline-end: thin solid var(--border-th) !important;
                    padding-inline-end: var(--side-margin);

                    + td {
                        padding-inline-start: var(--side-margin) !important;
                    }
                }
            }

            /* Date, place, etc. */
            table {
                margin-block: var(--side-margin) !important;

                th {
                    font-stretch: var(--side-body-stretch);
                    font-weight: var(--bold);
                }

                :is(td, th) {
                    text-align: start;
                    vertical-align: top;
                }
            }
        }

        /***************************/
        /* Template:Infobox person */
        /***************************/

        &.vcard.vcard {
            .honorific-prefix,
            .honorific-suffix {
                font-size: var(--caption-size) !important;
                font-weight: var(--normal-weight) !important;
                line-height: inherit !important;
            }

            .infobox-header[style*=padding] {
                padding-block-end: 0 !important;
            }

            > tbody > tr {
                &:has(+ tr > td > table:first-child) > * {
                    padding-block-end: var(--side-margin);

                    &.infobox-label {
                        padding-block-end: calc(var(--side-margin) + var(--label-baseline-align));
                    }
                }

                > td > table {
                    border-block-start: thin solid var(--fg);
                    margin: 0 !important;

                    > tbody > tr:first-child > th {
                        border: 0 !important;
                        padding-inline: 0 !important;
                        padding-block: var(--side-margin) 0 !important;
                    }
                }
            }

            .infobox-below:has(> :empty:first-child:last-child) {
                display: none;
            }

            .skin-nightmode-reset-color {
                background: transparent !important;
            }
        }

        /*******************************/
        /* Template:Infobox settlement */
        /*******************************/

        &.ib-settlement > tbody > tr {
            &:has(> .infobox-subheader):has(+ .ib-settlement-official) > * {
                padding-block-end: 0;
            }

            &.ib-settlement-official > * {
                font-size: var(--caption-size);
                border-block-start: 0;
                padding-block-start: 0;
            }
        }

        .ib-settlement-official > * {
            font-stretch: normal;
            text-align: center;
        }

        .ib-settlement-native,
        .ib-uk-place-other-names {
            font-size: var(--caption-size);
            font-stretch: normal;
            font-weight: var(--normal-weight);
            padding: 0;
        }

        .ib-settlement-caption,
        .ib-settlement-caption-link,
        .sidebar-caption {
            font-size: var(--caption-size);
            font-stretch: normal;
            line-height: 1.4;
            text-align: justify;
            text-align-last: center;
        }

        .ib-settlement-caption-link {
            padding-block-end: 0;
        }

        .ib-settlement-cols + .ib-settlement-cols {
            margin-block-start: calc(var(--side-margin) * 2);
        }

        .ib-settlement-cols-cell {
            vertical-align: bottom;
        }

        /*******************************/
        /* Template:Infobox television */
        /*******************************/

        &.ib-tv {
            border-collapse: collapse;
        }

        .ib-tv-channel-availability {
            > .infobox-header {
                font-stretch: normal;
                text-align: center;
            }

            + tr:has(> .infobox-full-data:empty) {
                display: none;
            }
        }

        /***************************/
        /* Template:Sidebar person */
        /***************************/

        &.sidebar-person {
            --image-w: 3em;

            border-color: var(--fg) !important;

            hr {
                display: none;

                &:not(:first-child) {
                    margin-block-start: var(--side-margin);

                    ul + & + ul {
                        margin-block-start: 0;
                    }
                }
            }

            .hidden-begin {
                font-size: inherit;
            }

            .hidden-title,
            .sidebar-content > [style*=font-weight],
            .sidebar-content > .mw-collapsible > [style*=font-weight] {
                border-block: 0;
                font-size: var(--side-head-font-size) !important;
                font-stretch: var(--side-body-stretch);
                font-weight: var(--bold) !important;
                line-height: calc(var(--side-line-height) / var(--side-font-size)) !important;
                margin-block: var(--side-margin) 0 !important;
                margin-inline: 0 !important;
            }

            .sidebar-content > hr:first-child + .hidden-begin > .hidden-title {
                margin-block-start: 0 !important;
            }

            .hidden-content {
                text-align: start !important;
            }
        }

        .sidebar-person-title-image,
        .sidebar-person-title {
            background: transparent !important;
            color: var(--fg) !important;
            padding: 0;
        }

        .sidebar-person-title-image {
            inline-size: var(--image-w);

            img {
                max-block-size: 1lh;
                max-inline-size: var(--image-w);
            }
        }

        .sidebar-person-title {
            font-stretch: normal;
            font-weight: var(--normal-weight);
            padding-inline-end: var(--image-w);

            > div {
                font-size: 1rem;
            }

            .vcard {
                font-stretch: var(--side-title-stretch);
                font-weight: var(--bold);
            }
        }

        /***********************/
        /* Template:Speciesbox */
        /***********************/

        &.biota {
            [data-wiki-rs~=template-phanerozoic-220px] {
                font-size: inherit !important;

                + br {
                    display: none;
                }
            }

            > tbody > tr {
                > th {
                    background: transparent !important;

                    &[colspan] {
                        border-block: thin solid var(--fg);
                        border-block-end-color: var(--border-th);
                        padding-block: var(--side-margin);
                    }
                }

                &:first-child > th {
                    background: transparent !important;
                    border-block-end: thin solid var(--fg);
                    color: var(--fg);
                    font-size: var(--big-caption);
                    font-stretch: var(--side-title-stretch);
                    padding-block: var(--side-margin);

                    > div {
                        border-block-start: thin solid var(--fg);
                        font-size: 1rem;
                        font-stretch: normal;
                        font-weight: var(--normal-weight);
                        margin-block-start: var(--side-margin);
                        padding-block-start: var(--side-margin);
                    }
                }

                &:has(> th[colspan]) + tr > * {
                    padding-block-start: var(--side-margin);
                }

                &:has(+ tr > th[colspan]) > *,
                &:last-child > * {
                    padding-block-end: var(--side-margin);
                }
            }
        }
    }

    /***************************/
    /* Template:Largest cities */
    /***************************/

    [data-wiki-rs~=template-largest-cities] {
        > table {
            border-block-start: 3px solid currentColor !important;
            border-color: var(--border-fg) !important;
            border-inline: none !important;
            font-size: 1em !important;
            font-variant-numeric: tabular-nums;
            inline-size: var(--table-width) !important;
            margin-inline: var(--table-margin-inline) !important;
        }

        td {
            padding: .25em;

            &:first-child {
                padding-inline-start: var(--table-padding-inline);
            }

            &:last-child {
                padding-inline-end: var(--table-padding-inline);
            }

            &:has(+ .largestCities-cell-background) {
                padding-inline-end: 1em;
            }

            &:not([rowspan]) + .largestCities-cell-background {
                border-inline-start: thin solid var(--border-fg);
            }
        }

        th {
            border-block-end: thin solid var(--border-fg);

            span[style*=font-size] {
                font-stretch: var(--side-title-stretch);
            }
        }

        tr:nth-child(2n + 1) td:not([rowspan]) {
            background-color: var(--shade-bg);
        }
    }

    .largestCities-cell-background {
        background-color: transparent;
    }

    /*******************/
    /* Template:Legend */
    /*******************/

    /* This is a colour swatch. Used in 'Canada' and 'McDonnell Douglas MD-11'.
       It is also inexplicably used as a wrapper for things like bus numbers. */
    .legend-color:not(:has(> .legend-text, > :any-link)) {
        block-size: var(--legend-wh);
        border-color: var(--legend-border);
        line-height: var(--legend-lh);
        min-inline-size: var(--legend-wh);
        vertical-align: var(--legend-valign);
    }

    /*************************/
    /* Template:Location map */
    /*************************/

    .switcher-container {
        margin-block-start: calc(var(--box-margin) * .5);

        /* No scripts, no switching, no reason to display many placeholder
           images in a row */
        > :nth-child(n+2) {
            display: none;
        }
    }

    .locmap {
        font-stretch: var(--side-body-stretch);
        text-align: center;

        img {
            display: block;
        }

        .od {
            font-stretch: normal;
        }
    }

    /*******************/
    /* Template:Markup */
    /*******************/

    [data-wiki-rs~=template-markup] {
        margin-inline: var(--table-margin-inline) !important;
        inline-size: var(--table-width) !important;

        * + & {
            margin-block-start: var(--box-margin) !important;
        }

        > tbody > tr > td {
            border: 0 !important;
            padding-block: var(--table-padding-block) !important;
            padding-inline: var(--table-padding-inline) !important;

            + td:not([style*="border-style: none"]) {
                border: thin solid var(--border-fg) !important;
            }
        }
    }

    /******************/
    /* Template:Mbox  */
    /* Template:Ambox */
    /* Template:Cmbox */
    /* Template:Fmbox */
    /* Template:Imbox */
    /* Template:Ombox */
    /* Template:Tmbox */
    /******************/

    .ambox,
    .cmbox,
    .fmbox,
    .imbox,
    .ombox,
    .tmbox {
        background: var(--box-tag);
        border: 0;
        font-family: var(--sans);
        margin-inline: 0;

        img {
            aspect-ratio: 1;
            display: block;
        }

        hr {
            margin-block: .5rem calc(.5rem - 1px);
            margin-inline: 0;
        }

        :is(.mw-parser-output, .documentation, .excerpt, .excerpt-block) > & {
            margin-block-start: var(--box-margin);
        }
    }

    .mbox-text {
        padding: 0;
    }

    .mbox-image {
        padding-block: .1rem 0;
        padding-inline: .3rem;
        vertical-align: top;
    }

    .mbox-empty-cell {
        padding-inline-start: .5rem;
    }

    .mbox-small.mbox-small {
        margin-block: 0 var(--figure-margin);
        margin-inline: var(--figure-margin) 0;

        * + & {
            margin-block-start: var(--box-margin);
        }
    }

    .compact-ambox .ambox {
        background: none;
        /* !important: Module’s own CSS uses !important */
        margin-inline-start: 0 !important;
    }

    /*******************/
    /* Template:Navbar */
    /*******************/

    .navbar-mini {
        font-stretch: var(--side-title-stretch);
    }

    .navbar-ct-full,
    .navbar-ct-mini {
        font-size: inherit;
    }

    /*******************/
    /* Template:Navbox */
    /*******************/

    /* nest everything to increase specificity, since the templatestyles uses
       complex selectors with high specificities */
    .navbox {
        &.navbox,
        .navbox-abovebelow,
        .navbox-even,
        .navbox-group,
        .navbox-list,
        .navbox-odd,
        .navbox-subgroup,
        .navbox-title {
            /* !important: 'Sociology' */
            background-color: transparent !important;
            border: 0;
        }

        &.navbox {
            border-block-start: 3px solid currentColor;
            margin-inline: 0;
            /* !important: 'Crazy Taxi' */
            padding: 0 !important;

            li {
                padding-inline-start: 0;
            }
        }

        /* There is a much more pleasant way to do this, which is to use
           border-top on `tr + tr`. Unfortunately, to make sure there is a
           bottom border on a last row but *not* on a `.navbox-abovebelow`, the
           border has to be put on the bottom so it can be erased by
           `.navbox-abovebelow`. */
        tr > :is(
            .navbox-abovebelow,
            .navbox-group,
            .navbox-image,
            .navbox-list,
            .navbox-title
        ) {
            border-block-end: thin solid var(--border-fg);
        }

        tr:last-child > .navbox-abovebelow {
            border-block-end: 0;
        }

        .navbox-abovebelow,
        .navbox-group,
        .navbox-title {
            font-family: var(--sans);
        }

        .navbox-abovebelow {
            font-size: var(--caption-size);
        }

        /* 'Wikipedia:Five pillars' uses this */
        .navbox-columns-table {
            strong {
                font-family: var(--sans);
            }

            > tbody > tr > .navbox-list + .navbox-list > .navbox-subgroup {
                border-inline-start: thin solid var(--border-fg) !important;
            }

            .navbox-list {
                &:not(.navbox-list-with-group) {
                    border: 0 !important;
                }

                &:not(:has(.navbox-subgroup)) + * {
                    padding-inline-start: calc(var(--box-margin) * .25) !important;
                }
            }
        }

        .navbox-group {
            /* When navbox titles are rotated, as in 'Template:Carnivora', the
               inline styles set widths and rely on the content box model to
               avoid visual overflow */
            box-sizing: content-box;

            &:has(+ td .navbox-subgroup) {
                border-inline-end: thin solid var(--border-fg);
            }

            /* 'Template:Solar system' */
            &[scope=row][style*="text-align"] {
                text-align: end !important;
            }
        }

        .navbox-image {
            display: none;
        }

        .navbox-list + .navbox-list {
            /* !important: 'Template:IBM personal computers' */
            border-inline-start: thin solid var(--border-fg) !important;
        }

        /* 'Template:Mozilla' uses one of these weirdo hybrids */
        .navbox-list-with-group > div:first-child:not(:empty) {
            &:has(~ .navbox-subgroup) {
                /* !important: 'Template:Mozilla' */
                padding-inline: 1rem !important;
            }

            ~ .navbox-subgroup {
                border-block-start: thin solid var(--border-fg);
            }
        }

        .navbox-subgroup tr:last-child > :is(
            .navbox-abovebelow,
            .navbox-group,
            .navbox-image,
            .navbox-list
        ) {
            border-block-end: 0;
        }

        .navbox-title {
            font-size: 1rem;
            font-stretch: var(--side-title-stretch);

            > :not(.navbar) {
                /* !important: Pages like 'Crazy Taxi' on an anonymous
                container */
                font-size: 1rem !important;
            }
        }

        /* This is more closely related to 'Template:Sidebar' than to
           'Template:Navbox', but is used as part of
           'Template:Infobox military conflict' on e.g. 'World War II' */
        .navbox-vertical.navbox-vertical {
            font-family: var(--sans);
            font-size: 1rem;
            line-height: var(--side-line-height);

            .navbox-title {
                border-block-end-color: var(--fg);
                font-size: var(--big-caption);
                line-height: var(--side-title-lh);
                padding-block: var(--side-title-margin);
                padding-inline: 0;

                .navbar-mini {
                    font-size: 90%;
                    margin-inline-start: .5em;
                }

                [style*=font-size] {
                    font-size: inherit !important;
                }

                [style*=margin] {
                    margin-inline: 3em !important;
                }

                [style*=line-height] {
                    line-height: inherit !important;
                }
            }

            .navbox-list {
                border-block-color: var(--fg);
                font-stretch: var(--side-body-stretch);
                line-height: var(--side-line-height);
                padding-block-end: var(--side-margin) !important;
                text-align: start;

                [style*=padding] {
                    padding-inline: 0 !important;
                }

                &.hlist ul {
                    padding-block: 0;
                }

                > div > b,
                > div > p > b {
                    display: block;
                    font-size: var(--side-head-font-size);
                    line-height: calc(var(--side-line-height) / var(--side-font-size));
                    padding-block-start: var(--side-margin);
                }
            }
        }

        .hlist td ul {
            + ul {
                padding-block-start: 0;
            }

            &:has(+ ul) {
                padding-block-end: 0;
            }
        }

        .wikitable,
        table.sortable {
            border-block-end: 0;
            inline-size: 100%;
            margin-inline: 0;

            &[style*=line-height] {
                line-height: 1rlh !important;
            }

            > tbody > tr > * {
                &:first-child {
                    padding-inline-start: var(--table-padding-inline);
                }

                &:last-child {
                    padding-inline-end: var(--table-padding-inline);
                }
            }
        }

        [style*="padding:0 0.25em"] > :is(.wikitable, table.sortable) {
            inline-size: calc(100% + .5em) !important;
            margin-inline: -.25em !important;
        }

        /* !important: 'Template:New York City', and others */
        [style*="box-shadow:"]:is(
            .navbox-abovebelow,
            .navbox-group,
            .navbox-title
        ) {
            box-shadow: none !important;
        }

        /* !important: 'Template:New York City' and 'Template:Mosques in India'
           and 'Template:Manchester United F.C.'.
           Caution is required because 'Template:Wikipedia policies and
           guidelines' uses colour differently in a way which is not so bad */
        [style*="color\:"]:is(
            .navbox-abovebelow,
            .navbox-abovebelow :any-link *,
            .navbox-group,
            .navbox-group :any-link *,
            .navbox-title,
            .navbox-title *
        ) {
            color: unset !important;
        }
    }

    .navbox-styles {
        display: none;
    }

    /* extra specificity to override `.navbox + .navbox-styles + .navbox` */
    > * + .navbox.navbox.navbox,
    .documentation > * + .navbox.navbox {
        clear: both;
        margin-block-start: var(--footer-margin) !important;
    }

    /***********************************/
    /* Template:Periodic table (micro) */
    /***********************************/

    [data-wiki-rs~=template-periodic-table--micro-] {
        border-block: thin solid var(--fg) !important;
        border-inline: 0 !important;
        font-family: var(--sans);
        padding-block: var(--side-margin) !important;
        padding-inline: 0 !important;

        &[style*="float:right"] {
            margin-block-end: var(--figure-margin) !important;
            margin-inline: var(--figure-margin) 0 !important;
        }

        * + & {
            margin-block-start: var(--box-margin) !important;
        }

        table {
            background: var(--bg) !important;
            position: relative;

            &::before {
                background: var(--bar-fill);
                content: '';
                inset: 0;
                mix-blend-mode: overlay;
                opacity: .7;
                pointer-events: none;
                position: absolute;
                z-index: 1;
            }
        }
    }

    #micro-periodic-table-title {
        background: transparent !important;
    }

    #micro-periodic-table-caption {
        padding-block-start: var(--side-margin);
    }

    /************************************/
    /* Template:Periodic table (navbox) */
    /************************************/

    [aria-describedby="periodic-table-legend"] {
        background-color: var(--bg);
        border-collapse: separate;
        border-spacing: 1px;
        font-variant-numeric: normal;
        position: relative !important;

        div:has(> &) {
            padding: 0 !important;
        }

        &::before {
            background: var(--bar-fill);
            content: '';
            inset: 0;
            mix-blend-mode: overlay;
            opacity: .7;
            pointer-events: none;
            position: absolute;
            z-index: 1;
        }

        > tbody > tr {
            > td {
                font-family: var(--sans);
                font-stretch: var(--side-body-stretch);

                .mw-selflink {
                    font-stretch: normal;
                }
            }

            > th,
            > td > span {
                position: relative;
                z-index: 2;
            }
        }
    }

    #periodic-table-legend {
        background: transparent !important;
        border: 0 !important;
        font-family: var(--sans);

        div:has(> &) {
            padding: 0 !important;
        }

        > div {
            padding: 0 !important;

            > table {
                line-height: 1rlh !important;
            }
        }

        td {
            background-image: var(--bar-fill) !important;
            background-blend-mode: overlay;
        }
    }

    /******************************/
    /* Template:Phanerozoic 220px */
    /******************************/

    [data-wiki-rs~=template-phanerozoic-220px] {
        font-size: 1em !important;

        * {
            font-stretch: 50%;
            padding: 0 !important;
        }

        > * {
            background: transparent !important;
        }

        > [name=Range] {
            pointer-events: none;

            * {
                font-size: 90% !important;
                font-stretch: normal;
                font-weight: var(--bold);
            }
        }

        > * + [data-wiki-rs~=template-fossil-range-bar] {
            border-inline-start: thin dotted var(--fg);
        }

        a {
            display: block;
            line-height: 100%;

            &:any-link {
                font-weight: var(--normal-weight);
            }
        }
    }

    /**********************/
    /* Template:Pie chart */
    /**********************/

    .pie-thumb .smooth-pie-container {
        padding: 0;
    }

    /* TODO: Just force the colours to be the sequence of pretty ones always.
       This is not possible in CSS alone because sometimes one slice is actually
       drawn using multiple elements.
       As a side-note, the best looking output relies on filter creating wide
       gamut colours that get blended and then clamped into sRGB range since it
       allows some slices to be patterned and others to be solid with the same
       colour based on the intensity of the filter. */
    .smooth-pie,
    .smooth-pie-legend .l-color {
        filter: saturate(200%) contrast(200%) brightness(200%) hue-rotate(50deg);
    }

    .smooth-pie {
        &::before {
            background: var(--bar-fill);
            border-radius: 50%;
            content: '';
            inset: 0;
            mix-blend-mode: overlay;
            pointer-events: none;
            position: absolute;
            z-index: 1;
        }

        [title] {
            cursor: help;
        }
    }

    .smooth-pie-legend .l-color {
        background-blend-mode: overlay;
        background-image: var(--bar-fill) !important;
        background-size: 4px 4px !important;
    }

    /***************************/
    /* Template:Portal         */
    /* Template:Portal bar     */
    /* Template:Shortcut       */
    /* Template:Side box       */
    /* Template:Sister bar     */
    /* Template:Sister project */
    /***************************/

    .module-shortcutboxplain {
        background: var(--box-tag);
        border: 0;
        font-family: var(--sans);
        margin-block: 0 var(--figure-margin);
        margin-inline: var(--figure-margin) 0;
        padding: 0;
        padding-inline-start: var(--tag-size);

        > * + * {
            margin: 0;
        }
    }

    .module-shortcutlist {
        border: 0;
    }

    .portal-bar,
    .sister-bar {
        font-family: var(--sans);
        margin-block-start: var(--footer-margin);

         + :is(.sister-bar, .portal-bar) {
            border-block-start: none;
            margin-block-start: 0;
         }
    }

    .portal-bar-bordered,
    .sister-bar {
        background-color: transparent;
        border: 0;
        border-block-end: thin solid var(--border-fg);
        border-block-start: thin solid var(--border-fg);
    }

    .portalborder {
        background: var(--box-tag);
        border: 0;
        padding-block: .25rem;
        padding-inline: var(--tag-size);

        &.portalright {
            padding-inline-end: 0;
            transform: var(--aside-gutter-align);
        }
    }

    .portalbox {
        background: var(--box-tag);
        padding-block-start: .25rem;
        padding-inline-start: var(--tag-size);

        * + & {
            margin-block-start: var(--box-margin);
        }
    }

    .portalbox-entry {
        block-size: auto;
        display: block;
        font-family: var(--sans);
        font-size: 88%; /* match side-box */
        font-style: normal;
        font-weight: var(--normal-weight);
        line-height: 1;

        + .portalbox-entry {
            margin-block-start: calc(var(--box-margin) * .25);
        }
    }

    .portalbox-image,
    .portalbox-link {
        padding: 0;
    }

    .portalbox-image img {
        max-block-size: 1cap;
        max-inline-size: 1cap;
    }

    .portalbox-link {
        padding-inline-start: .3em;
    }

    .side-box {
        border: 0;
        background: var(--box-tag);
        font-family: var(--sans);

        .side-box-text {
            padding-block: 0;
        }

        * + hr {
            margin-block-start: calc(var(--box-margin) * .25);
        }

        > * + * {
            margin-block-start: calc(var(--box-margin) * .25);
        }
    }

    .side-box-right {
        margin-block-end: var(--figure-margin);
        margin-inline-start: var(--figure-margin);
        transform: var(--aside-gutter-align);

        .side-box-text {
            padding-inline-end: 0;
        }

        * + & {
            margin-block-start: var(--box-margin);
        }

        + .side-box-right {
            margin-block-start: calc(var(--figure-margin) * -.5);
        }
    }

    .sister-box {
        .side-box-abovebelow {
            padding-block: 0;
            padding-inline: .9em;
            text-align: start;
        }

        .side-box-text > ul {
            border-block-start: thin solid var(--fg);
            margin-inline: 0;
            margin-inline-start: calc(-1cap - 4px);
            padding-block: calc(var(--box-margin) * .25) 0;
            padding-inline: 0;

            > li {
                min-block-size: 0;

                + * {
                    margin-block-start: calc(var(--box-margin) * .25);
                }
            }
        }
    }

    .sister-logo {
        inline-size: auto;
        line-height: unset;
        vertical-align: top;

        /* Without images to load, avoid blowing out the layout */
        img {
            max-block-size: 1cap;
            max-inline-size: 1cap;
        }
    }

    /**********************/
    /* Template:Quote box */
    /**********************/

    .quotebox {
        background: transparent !important;
        color: var(--fg) !important;
        border: 0;
        border-block-end: thin solid currentColor;
        border-block-start: 3px solid currentColor;
        padding-block: calc(var(--box-margin) * 2) calc(var(--box-margin) * 2);
        padding-inline: calc(var(--box-margin) * 2) var(--box-margin);

        &.floatright,
        &.floatleft {
            margin-block: var(--box-margin) var(--figure-margin);
            margin-inline: var(--figure-margin) calc(var(--box-margin) * -1);
            max-inline-size: var(--aside-max);
            min-inline-size: var(--aside-min);
        }

        &.floatleft {
            margin-inline: calc(var(--box-margin) * -1) var(--figure-margin);
        }

        .left-aligned {
            text-align: justify;
        }

        cite {
            font-style: italic;

            /* 'Social class' uses this and it looks bad */
            &.left-aligned {
                text-align: end;
            }
        }
    }

    /********************/
    /* Template:Reflist */
    /********************/

    .refbegin,
    .reflist {
        font-size: inherit;
        margin-block-end: 0;
    }

    .refbegin-hanging-indents > ul {
        padding-inline-start: 2em;

        > li {
            padding-inline-start: 0;
            text-indent: -2em;
        }
    }

    .reflist-columns {
        gap: calc(var(--ol-gutter) * 2);
    }

    /*********************/
    /* Template:Routemap */
    /*********************/

    .RMbox {
        border-block-end: 3px solid var(--fg);
        box-shadow: none;
        font-family: var(--sans);

        > tbody > tr {
            &:first-child > th {
                background-image: linear-gradient(transparent 3px, var(--bg) 3px) !important;
                border-block-end: thin solid var(--border-fg);
                color: var(--fg) !important;
                font-stretch: var(--side-title-stretch);
                line-height: 1;
                padding-block-start: calc(5px + 3px) !important;
                vertical-align: baseline;

                [style*=color] {
                    color: unset !important;
                }
            }

            &:not(:first-child) > th {
                border-block-start: thin solid var(--border-fg) !important;
                font-stretch: 100%;
            }

            &:last-child > * {
                padding-block-end: calc(var(--box-margin) * .5);

                &:last-child {
                    margin-block-end: 0;
                }
            }

            > td:has(> .selfreference) {
                padding-block-start: 0 !important;
                padding-inline: 0 !important;
            }

            &:has(+ tr .autocollapse) > td {
                padding-block-end: calc(var(--box-margin) * .5) !important;
            }
        }

        .autocollapse > tbody > tr:first-child > th
        /* , > tbody > tr:not(:first-child) > th  */
        {
            background-color: transparent !important;
            border-block-start: 3px solid var(--fg) !important;
            color: var(--fg) !important;
            font-stretch: var(--side-title-stretch);
            padding: 0 !important;
        }

        .routemap {
            font-stretch: var(--side-body-stretch);
        }

        .selfreference {
            border-block-end: thin solid var(--border-th);
            font-size: 100% !important;
            padding-block: calc(var(--box-margin) * .25);
        }
    }

    > .RMbox[style*="float:right"] {
        margin-inline-start: var(--figure-margin) !important;
        margin-block-end: var(--figure-margin) !important;
        transform: var(--aside-gutter-align);
    }

    .RMinline:last-child {
        margin-block-end: 0 !important;
    }

    .routemap {
        font-stretch: var(--side-body-stretch);

        .RMr1.RMr1,
        .RMl1.RMl1 {
            font-variant-numeric: lining-nums;
            /* !important: Module’s own CSS uses !important */
            padding-inline: 1em !important;
        }
    }

    /***********************/
    /* Template:Row header */
    /***********************/

    .table-rh {
        /* !important: Even though this template uses a class, it still also
           unconditionally inlines styles */
        background-color: transparent !important;
        color: inherit !important;
        font-family: var(--sans);
        line-height: 1.2;

        > .hatnote {
            font-weight: var(--normal-weight) !important;
            margin-block-start: calc(var(--box-margin) * .5);
        }
    }

    /********************/
    /* Template:S-start */
    /********************/

    .succession-box.succession-box {
        border-block-start: thin solid var(--border-fg);
        inline-size: 100%;
        margin-block: 0 !important;
        margin-inline: 0 !important;
        max-inline-size: none;

        &:has(+ .navbox-styles, + .navbox) {
            margin-block: var(--footer-margin) 0 !important;
        }

        .navbox & {
            border: none;
            inline-size: 100%;
            margin: 0 !important;
        }

        * {
            text-align: inherit;
        }

        > tbody > tr {
            background-color: transparent;

            > td {
                border-block-end: thin solid var(--border-fg);
                font-size: .88rem;

                &[style*=border] {
                    border-block-start-width: 3px !important;
                }

                [style*=font-size] {
                    display: block;
                    font-family: var(--sans);
                    font-size: .95em !important;
                }
            }

            > th {
                border-block-start-width: 3px !important;
                font-size: 1rem;
                font-stretch: var(--side-title-stretch);
            }

            &:first-child > td[colspan] {
                font-family: var(--sans);
                font-size: 1rem;
                font-stretch: var(--side-title-stretch);
            }
        }
    }

    /*****************************/
    /* Template:Spoken Wikipedia */
    /*****************************/

    .spoken-wikipedia {
        border: 0;
        border-block-start: 3px solid currentColor;
        font-family: var(--sans);
    }

    .spoken-wikipedia-disclaimer {
        hyphens: manual;
    }

    /******************/
    /* Template:Stack */
    /******************/

    .stack.stack.stack {
        &.stack-clear-right,
        &.stack-right {
            margin-block-end: var(--figure-margin);
            margin-inline-start: var(--figure-margin);
            min-inline-size: var(--aside-min);

            > * > * {
                min-inline-size: var(--aside-min);
            }
        }

        > * > * {
            border-block-end: none;
            float: none;
            margin: 0 !important;

            + * {
                margin-block-start: calc(var(--box-margin) * .25) !important;
            }
        }
    }

    /*******************************/
    /* Template:Static row numbers */
    /*******************************/

    .static-row-numbers.static-row-numbers.wikitable {
        font-variant-numeric: tabular-nums;

        > tbody > tr {
            &::before {
                font-family: var(--sans);
                inline-size: 0;
                padding-block: var(--table-padding-block);
                padding-inline: var(--table-padding-inline);
            }

            &:has(> th[scope=col])::before {
                /* !important: 'Template:Static row numbers' styles does it */
                border-block-end: thin solid var(--border-th) !important;
                counter-increment: none;
                content: "";
            }

            &:first-child:has(> th[scope=col]):has(+ tr > th[scope=col])::before {
                border-block-end: 0 !important;
            }

            &::before {
                border: 0;
            }

            &.static-row-header:not(.sortbottom, .sorttop)::before {
                border-block-end: thin solid var(--border-th);
            }
        }
    }

    .static-row-header-text.static-row-numbers > tbody:first-child > tr:first-child:has(+ tr > th[scope=col], + .static-row-header) {
        &::before {
            content: "";
        }

        + tr::before {
            content: "No.";
            font-weight: var(--bold);
        }
    }

    .static-row-header-hash.static-row-numbers > tbody:first-child > tr:first-child:has(+ tr > th[scope=col], + .static-row-header) {
        &::before {
            content: "";
        }

        + tr::before {
            content: "#";
            font-weight: var(--bold);
        }
    }

    .sticky-header-multi {
        > tbody > tr:first-child {
            position: sticky;
            inset-block-start: 0;
        }
    }

    /******************************/
    /* Template:Talk quote inline */
    /******************************/

    .inline-quote-talk {
        font-family: var(--serif);
    }

    /************************************/
    /* Template:Template journal inline */
    /************************************/

    .tj-tape {
        font-family: var(--mono);
    }

    /**************************************/
    /* Template:Timeline of release years */
    /**************************************/

    .release-timeline {
        border-collapse: separate;
        border-spacing: 0 1px;
        clear: inline-end;
        font-family: var(--sans);
        font-size: 95%;
        float: inline-end;
        inline-size: auto;
        line-height: inherit;
        margin-block: 0 var(--figure-margin);
        margin-inline: var(--figure-margin) calc(var(--box-margin) * -1);
        padding: 0;
        transform: var(--aside-gutter-align);

        > caption {
            border-block-end: thin solid var(--border-th);
        }

        td, th {
            line-height: 1.2;
        }

        td {
            font-stretch: var(--side-body-stretch);
        }

        th[style*=border-right] {
            border-inline-end-width: .5ch !important;
        }
    }

    /**************************/
    /* Template:Track listing */
    /**************************/

    .tracklist-length.tracklist-length {
        text-align: end;
    }

    .tracklist-total-length.tracklist-total-length {
        background-color: var(--shade-bg);
        border-block-start: thin solid var(--border-th);
        font-family: var(--sans);
        text-align: end;

        > :is(td, th) {
            padding-block: var(--table-padding-block);

            &:last-child {
                text-align: end;
            }
        }
    }

    /********************/
    /* Template:Tracked */
    /********************/

    .tracked {
        background: var(--box-tag);
        border: 0;
        border-radius: 0;
        font-family: var(--sans);
        margin-block-end: var(--figure-margin);
        margin-inline-end: var(--figure-margin);
        padding-block: calc(var(--tag-size) / 2);
        padding-inline: var(--tag-size);
        text-align: start;
    }

    /**********************/
    /* Template:Var serif */
    /**********************/

    .var-serif {
        font-family: var(--serif);
        font-size: 1em;
    }

    /*******************************/
    /* Template:Video game reviews */
    /*******************************/

    .vgr-center {
        text-align: start;
    }

    .vgr-reviews caption {
        font-family: var(--sans);
    }

    .vgr-stacked {
        margin-block-start: calc(var(--box-margin) * .5);
    }

    .vgr-title {
        font-family: var(--sans);
    }

    .video-game-reviews {
        margin-block-end: var(--figure-margin);
        margin-inline-start: var(--figure-margin);
    }

    /************************/
    /* Template:Weather box */
    /************************/

    [data-wiki-rs~=template-weather-box] {
        .wikitable,
        /* A lot of pages like 'Jakarta' and 'Tromsø' shove an untemplated
           “climatic data” table right after the weather box, so heuristically
           match that too */
        + .wikitable {
            border-block-end: none;
            inline-size: var(--table-width) !important;

            td {
                border: solid var(--bg);
                border-width: thin 0 0 thin;
                font-family: var(--sans);
                font-size: 90%;
                text-align: center;
                text-align: "." end;
                inline-size: 6%;
                padding-inline: calc(var(--table-padding-inline) * .5);
                white-space: nowrap;

                &::first-line {
                    font-size: 1rem;
                }

                &:last-child {
                    padding-inline: var(--table-padding-inline);
                }

                &[style*="color:"] {
                    background-image: var(--bar-fill-light) !important;
                    background-blend-mode: soft-light;
                }
            }

            th[scope=col] {
                /* hiding the border gap requires using a unit with a known
                   size; `thin` is undefined in CSS */
                border-block-end-width: 1px;
                text-align: center;

                &[style*="border-left-width\:medium"] {
                    position: relative;
                    &::after {
                        border-block-end: 1px solid var(--border-th);
                        content: '';
                        /* "thin" and "medium" are unspecified in CSS */
                        inline-size: 12px;
                        inset-block-end: 0;
                        inset-inline-start: 0;
                        position: absolute;
                        /* TODO: CSS is missing logical translate */
                        transform: translate(-6px, 1px);
                    }
                }
            }

            tr {
                &:first-child > th {
                    font-weight: var(--normal-weight);

                    &::first-line {
                        font-weight: var(--bold);
                    }
                }

                &:nth-child(2) > th[scope=row] {
                    border-block-end: thin solid var(--border-th);
                }

                &:last-child,
                &:nth-last-child(2):has(> [colspan]) {
                    background: transparent;

                    > * {
                        /* !important: 'Tromsø' climatic data table */
                        background: transparent !important;
                        /* hiding the border gap requires using a unit with a known
                        size; `thin` is undefined in CSS */
                        border-block-start: 1px solid var(--border-fg);
                        line-height: 1rlh;

                        /* hiding the border gap */
                        &:last-child {
                            position: relative;

                            &::before {
                                border-block-start: 1px solid var(--border-fg);
                                content: '';
                                inset-block-start: -1px;
                                inset-inline: 0;
                                position: absolute;
                            }
                        }
                    }

                    + tr:last-child > * {
                        border-block-start: 0;

                        &:last-child::before {
                            display: none;
                        }
                    }
                }
            }
        }

        /* !important: 'Jakarta' */
        + .wikitable {
            margin-inline: var(--table-margin-inline) !important;

            tr:nth-child(2) > th {
                border-block-end: 1px solid var(--border-th);

                &:last-child {
                    position: relative;

                    &::after {
                        border-block-end: 1px solid var(--border-th);
                        content: '';
                        /* "thin" and "medium" are unspecified in CSS */
                        inline-size: 12px;
                        inset-block-end: 0;
                        inset-inline-start: 0;
                        position: absolute;
                        /* TODO: CSS is missing logical translate */
                        transform: translate(-6px, 1px);
                    }
                }
            }
        }
    }

    /***************/
    /* Template:Xt */
    /***************/

    .example:not(.monospaced) {
        font-family: var(--serif) !important;
    }
}
